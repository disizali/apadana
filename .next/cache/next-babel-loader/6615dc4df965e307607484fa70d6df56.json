{"ast":null,"code":"import _parseInt from \"@babel/runtime-corejs2/core-js/parse-int\";\nimport _classCallCheck from \"@babel/runtime-corejs2/helpers/esm/classCallCheck\";\nimport _createClass from \"@babel/runtime-corejs2/helpers/esm/createClass\";\nimport _possibleConstructorReturn from \"@babel/runtime-corejs2/helpers/esm/possibleConstructorReturn\";\nimport _getPrototypeOf from \"@babel/runtime-corejs2/helpers/esm/getPrototypeOf\";\nimport _inherits from \"@babel/runtime-corejs2/helpers/esm/inherits\";\nvar _jsxFileName = \"/Users/imac/Desktop/APADANA/components/Earth.jsx\";\nvar __jsx = React.createElement;\nimport React, { Component } from 'react';\n\nvar Earth =\n/*#__PURE__*/\nfunction (_Component) {\n  _inherits(Earth, _Component);\n\n  function Earth() {\n    _classCallCheck(this, Earth);\n\n    return _possibleConstructorReturn(this, _getPrototypeOf(Earth).apply(this, arguments));\n  }\n\n  _createClass(Earth, [{\n    key: \"componentDidMount\",\n    value: function componentDidMount() {\n      //(function(){\n      var AMOUNT = 200,\n          d = 25,\n          R = 200,\n          adjustment = true,\n          adaptive = true,\n          obliquity = 23 / 180 * 3.14,\n          roV1 = .0022,\n          roV2 = -.0005,\n          ro1 = 0,\n          ro2 = 0,\n          canvas = '#earth',\n          color = '#420236',\n          fogC = '#722779',\n          T_earth = 'https://mapplix.github.io/earth/earth.png';\n      var camera, scene, renderer;\n      var positions = [],\n          particles,\n          particle,\n          count = 0,\n          dpr,\n          lastW,\n          W = window.innerWidth,\n          H = window.innerHeight,\n          aspect = W / H,\n          vMin = Math.min(W, H);\n      var mouseX = 0,\n          mouseY = 0,\n          x0,\n          y0;\n      var lookAt = new THREE.Vector3(0, 0, 0),\n          canvas = document.querySelector(canvas);\n      renderer = new THREE.WebGLRenderer({\n        alpha: true,\n        antialias: true,\n        canvas: canvas\n      }); //\n\n      renderer.setSize(W, H); //renderer.context.getExtension('OES_standard_derivatives');\n\n      camera = new THREE.PerspectiveCamera(18, aspect, 1, 10000);\n      scene = new THREE.Scene();\n      var Emap = new THREE.TextureLoader().load(T_earth);\n      Emap.anisotropy = Math.min(8, renderer.capabilities.getMaxAnisotropy()) || 1;\n      var Wmaterial = new THREE.MeshStandardMaterial({\n        onBeforeCompile: function onBeforeCompile(sh) {\n          sh.vertexShader = '\\\n#define MYSHADER\\n\\\nattribute float center, bright;\\n\\\nvarying vec3 vCenter, vPos, vV0, vV1, vV2;\\n\\\nvarying float vBright;\\n\\\n' + sh.vertexShader.replace(/}\\s*$/, '\\\nvBright=bright;\\n\\\nint c=int(center);\\n\\\nvCenter = vec3(c==0, c==1, c==2);\\n\\\nvPos=position;\\n\\\ngl_Position = projectionMatrix * modelViewMatrix * vec4(vPos, 1);\\n\\\nvV0=vCenter[0]*vPos;\\n\\\nvV1=vCenter[1]*vPos;\\n\\\nvV2=vCenter[2]*vPos;\\n\\\n}\\\t\t\t');\n          sh.fragmentShader = '\\\n#define MYSHADER\\n\\\nvarying vec3 vCenter, vPos, vV0, vV1, vV2;\\n\\\nvarying float vBright;\\n\\\n' + sh.fragmentShader.replace('#include <alphamap_fragment>', '\\\n#include <alphamap_fragment>\\n\\\nvec3 d = fwidth( vCenter );\\n\\\nvec3 a3 = smoothstep( vec3(0.0), d * 1.4, vCenter+0.4*d-1.0/fogDepth );\\n\\\nfloat scale = dot(normalize(vViewPosition), vNormal);\\n\\\nscale = 1.0-scale*scale;\\n\\\nfloat dist = distance(vPos, vV0.xyz/vCenter.x);\\n\\\ndist = min(dist, distance(vPos, vV1.xyz/vCenter.y));\\n\\\ndist = min(dist, distance(vPos, vV2.xyz/vCenter.z));\\n\\\nfloat b3 = smoothstep(1.5, 1.8, dist-1.5*scale*scale );\\n\\\nfloat edgeFactorTri=min(b3,min( min( a3.x, a3.y ), a3.z ));\\n\\\ndiffuseColor.a *= mix( 1.0,  0.0, edgeFactorTri );\\n\\\nfloat dissipation=' + (posZ + .5 * R + .01) + ';\\n\\\ndiffuseColor.a *= smoothstep( 20.0,  0.0, fogDepth-dissipation );\\n\\\n\\\t\t\t').replace('\t#include <fog_fragment>', '\\\nfloat lVc=length(vCenter);\\n\\\ngl_FragColor.rgb *= smoothstep( ' + R * .8888 + ', ' + R * 1.201 + ', fogDepth );\\n\\\ngl_FragColor.rgb = mix( gl_FragColor.rgb, vec3(3), (.1*lVc+pow(lVc,8.0))*vBright );\\n\\\n#include <fog_fragment>\\\n\\\t\t\t'); //console.log(sh, sh.vertexShader, sh.fragmentShader);\n        },\n        roughness: .5,\n        metalness: .964,\n        envMapIntensity: 5,\n        emissive: 0,\n        // refractionRatio: -0.12,\n        transparent: true,\n        alphaTest: 0.05\n      }); //, opacity: 0\n\n      Wmaterial.color.set(fogC);\n      Wmaterial.side = 2;\n      Wmaterial.extensions = {\n        derivatives: 1\n      };\n      var geometry = new THREE.IcosahedronGeometry(R, 3); //OctahedronGeometry\n\n      for (var i = 0; i < geometry.vertices.length; i++) {\n        geometry.vertices[i].applyEuler(new THREE.Euler(Math.random() * .06, Math.random() * .06, Math.random() * .06));\n      }\n\n      var bGeometry = new THREE.BufferGeometry().fromGeometry(geometry);\n      var position = bGeometry.attributes.position;\n      var centers = new Int8Array(position.count);\n      var brights = new Float32Array(position.count);\n      var points = [],\n          activePoints = [],\n          vCount = geometry.vertices.length,\n          dCount = 0,\n          dMid = 0;\n\n      for (var i = 0, l = position.count; i < l; i++) {\n        var c = centers[i] = i % 3,\n            j = (i - c) / 3;\n        brights[i] = 0;\n        if (i < vCount) points[i] = {\n          siblings: [],\n          distances: [],\n          indexes: [],\n          brightness: 0,\n          v: 0,\n          a: 0,\n          f: 0,\n          dr: 0,\n          r: 1\n        };\n      }\n\n      function addSiblings(a, b, one) {\n        if (points[a].siblings.indexOf(points[b]) < 0) {\n          points[a].pos = geometry.vertices[a].clone();\n          points[a].siblings.push(points[b]);\n          var d = geometry.vertices[a].distanceTo(geometry.vertices[b]);\n          points[a].distances.push(d);\n          dMid += d;\n          dCount++;\n        }\n\n        if (!one) addSiblings(b, a, 1);\n      }\n\n      geometry.faces.forEach(function (face, i) {\n        addSiblings(face.a, face.b);\n        addSiblings(face.a, face.c);\n        addSiblings(face.c, face.b);\n        points[face.a].indexes.push(i * 3);\n        points[face.b].indexes.push(i * 3 + 1);\n        points[face.c].indexes.push(i * 3 + 2);\n      });\n      dMid /= dCount;\n      var ttl = 10;\n\n      (function setActive(n) {\n        if (!n) return;\n\n        var i = _parseInt(Math.random() * vCount);\n\n        if (geometry.vertices[i].z < -100) setActive();else points[i].isActive = ttl, activePoints.push(points[i]);\n        setActive(n - 1);\n      })(10);\n\n      bGeometry.addAttribute('center', new THREE.BufferAttribute(centers, 1));\n      bGeometry.addAttribute('bright', new THREE.BufferAttribute(brights, 1));\n      var Ematerial = Wmaterial.clone();\n      Ematerial.alphaMap = Emap;\n      Ematerial.transparent = false;\n      Ematerial.side = 0;\n      var cubeCamera = new THREE.CubeCamera(1, 2 * R, 256);\n      cubeCamera.position.z = .47 * R;\n      Ematerial.envMap = cubeCamera.renderTarget.texture;\n      Ematerial.envMap.minFilter = THREE.LinearMipMapLinearFilter;\n      Ematerial.envMap.mapping = THREE.CubeReflectionMapping;\n      var Earth = new THREE.Mesh(new THREE.IcosahedronGeometry(R * .77, 3), Ematerial);\n      var wGeometry = geometry.clone();\n      particles = new THREE.Group();\n      world = new THREE.Group();\n      var Net = new THREE.Mesh(bGeometry, Wmaterial);\n      particles.add(Net, Earth); //new THREE.Points(geometry, Pmaterial), \n      //particles.rotation.order='YXZ'\n\n      world.add(particles);\n      scene.add(world); // POSITIONS :\n\n      var posZ = 1700; //distance to camera\n      //scene.position.set(-12,54,0);\n      //camera.position.y=camera.position.z=2000\n\n      scene.fog = new THREE.Fog(fogC, posZ - R / 2, posZ + R);\n      hLight = new THREE.HemisphereLight('#fff', 0, 23);\n      world.add(hLight);\n      hLight.position.set(0, 0, 1); // interactions\n\n      var dx,\n          dy = dx = x0 = y0 = 0,\n          active,\n          abc = ['a', 'b', 'c'],\n          movedPoints = [],\n          activeF = [],\n          ready,\n          raycaster = new THREE.Raycaster(),\n          mouse = new THREE.Vector2();\n\n      window.getWpos = function () {\n        return [scene.position, scene.rotation, camera];\n      };\n\n      function interact() {\n        mouse.x = x0 / W * 2 - 1;\n        mouse.y = -(y0 / H) * 2 + 1;\n        raycaster.setFromCamera(mouse, camera);\n        movedPoints.forEach(function (point, i) {\n          point.f = 0;\n        });\n        activeF = [];\n        if (!active) return;\n        var inters = raycaster.intersectObject(Net)[0],\n            ind,\n            vert;\n        if (!inters) return;\n        point = Net.worldToLocal(inters.point.clone());\n\n        for (var i = 0; i < 3; i++) {\n          ind = inters.face[abc[i]];\n          if (!points.some(function (p, i) {\n            return p.indexes.indexOf(ind) >= 0 && (vert = i + '');\n          })) return;\n          activeF[vert] = Math.max(1 - point.distanceTo(points[vert].pos) / dMid, 0) * 100;\n        } // console.log(activeF, points[vert]);\n\n      }\n\n      canvas.onpointerdown = canvas.onmousedown = canvas.ontouchstart = function (e) {\n        active = e.changedTouches ? e.changedTouches[0] : e;\n        x0 = active.clientX;\n        y0 = active.clientY;\n        e.preventDefault();\n        interact();\n      };\n\n      onpointermove = onmousemove = ontouchmove = function ontouchmove(e) {\n        if (!active || !ready) return;\n\n        if (!e.buttons) {\n          active = false;\n          return;\n        }\n\n        var touches = e.changedTouches;\n        if (active.identifier !== undefined && e.type != 'touchmove') return;\n\n        if (touches) {\n          if (touches[0].identifier == active.identifier) e = touches[0];else return;\n        } else {\n          e.preventDefault();\n        }\n\n        ; //if (e.type==mousemove && !e.which) return\n\n        dx = (5 * dx + x0 - (x0 = e.clientX)) / 6;\n        dy = (5 * dy + y0 - (y0 = e.clientY)) / 6; //console.log(e.type, active.identifier, dx, x0)\n\n        interact();\n        ready = 0;\n      };\n\n      onmouseup = onpointerup = ontouchup = ontouchcancel = onpointercancel = onblur = function onblur(e) {\n        active = false; //console.log()\n\n        interact();\n      };\n\n      var t0 = new Date() * 1,\n          dMax = 80,\n          dMin = 1000 / 33,\n          dT = 1000 / 50,\n          af,\n          Pactive = [],\n          m = 3000000,\n          k = 400,\n          k0 = 1,\n          f0 = .01,\n          fv = 1000,\n          posArr = bGeometry.attributes.position.array,\n          pUp = 0,\n          pDn = [],\n          flTimer = [],\n          vecTest = new THREE.Vector3(),\n          transStart,\n          pLast,\n          transactions = [];\n      requestAnimationFrame(function animate() {\n        requestAnimationFrame(animate);\n        var t = new Date() * 1,\n            dt = t - t0;\n        if (dt < dMin) return; // !Eh || \n\n        dt = Math.min(dt, dMax);\n        t0 = t;\n        var dd = dt / dT;\n        var pos = canvas.getBoundingClientRect(),\n            dY = window.innerHeight - document.documentElement.getBoundingClientRect().bottom;\n        if (pos.bottom <= 0 || pos.top >= window.innerHeight) return;\n\n        if (dpr != (dpr = window.devicePixelRatio) || W != (W = window.innerWidth) || H != (H = window.innerHeight)) {\n          vMin = Math.min(W, H);\n          renderer.setSize(W, H);\n          renderer.setPixelRatio(dpr);\n          camera.aspect = W / H;\n          camera.updateProjectionMatrix();\n        }\n\n        var addPoints = [];\n        activePoints.forEach(function (point, i) {\n          var b = point.brightness;\n\n          if (point.isActive && (b += (point.speed || .3) * (b + .05) * dd) > 1) {\n            //\n            point.siblings.forEach(function (s, j) {\n              if (activePoints.indexOf(s) > -1) return; //console.log(11);\n\n              s.speed = 3.7 / point.distances[j]; //s.from=point;\n\n              if (s.isActive = Math.random() > .6) activePoints.push(s);\n            });\n            point.isActive = 0;\n          } else if (!point.isActive && (b -= b * .056 * dd) < 0.005) {\n            b = 0; //point.from=\n\n            activePoints.splice(i, 1);\n          }\n\n          point.brightness = b;\n          point.indexes.forEach(function (i) {\n            brights[i] = b;\n          });\n        });\n        points.forEach(function (point, i) {\n          var d = 0;\n          point.siblings.forEach(function (s, j) {\n            d += s.dr;\n          });\n          d = d / point.siblings.length - point.dr;\n          point.f = -(activeF[i] || 0) * .4 + d * k - point.dr * k0 * (1 + Math.abs(1 - point.r)) - point.v * fv;\n          point.v += point.f * dt / m;\n          point.r = 1 + point.dr;\n          point.indexes.forEach(function (j) {\n            //brights[i]+=point.f; return;\n            posArr[j *= 3] = point.r * point.pos.x;\n            posArr[j + 1] = point.r * point.pos.y;\n            posArr[j + 2] = point.r * point.pos.z;\n          });\n        });\n        points.forEach(function (point, i) {\n          if (!point.v) return;\n          var dd = point.v * dt;\n          point.dr += dd;\n        });\n        bGeometry.attributes.bright.needsUpdate = true;\n        bGeometry.attributes.position.needsUpdate = true;\n        camera.position.z += (posZ - camera.position.z) * .085 * dd;\n        ro1 += roV1 * dd;\n        ro2 += roV2 * dd;\n        particles.rotation.set(0, 0, 0);\n        particles.rotateY(ro2).rotateX(obliquity).rotateY(ro1);\n        particles.rotation.y -= .0009;\n        dx *= 1 - .03 * dd;\n        dy *= 1 - .03 * dd;\n        ro2 -= dx * .002; //+(W/2-y0)*(W/2-x0)*dy/vMin*.00004;\n\n        world.rotation.x -= dy * .002;\n        var sro = world.rotation.x *= .92;\n        Net.applyMatrix(new THREE.Matrix4().getInverse(particles.matrixWorld).multiply(new THREE.Matrix4().makeRotationFromEuler(new THREE.Euler(-dy * .003, -dx * .002, 0))).multiply(particles.matrixWorld) //new THREE.Matrix4()\n        );\n        Earth.visible = !1;\n        scene.scale.set(.33, .33, .65); //.applyEuler(new THREE.Euler(-sro,0,0))\n\n        cubeCamera.update(renderer, scene);\n        Earth.visible = !0;\n        scene.scale.set(1, 1, 1);\n        particles.matrixWorldNeedsUpdate = true;\n        renderer.render(scene, camera);\n        ready = 1;\n      }); //})()\n    }\n  }, {\n    key: \"render\",\n    value: function render() {\n      return __jsx(\"div\", {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 298\n        },\n        __self: this\n      }, __jsx(\"canvas\", {\n        id: \"earth\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 299\n        },\n        __self: this\n      }));\n    }\n  }]);\n\n  return Earth;\n}(Component);\n\nexport { Earth as default };","map":{"version":3,"sources":["/Users/imac/Desktop/APADANA/components/Earth.jsx"],"names":["React","Component","Earth","AMOUNT","d","R","adjustment","adaptive","obliquity","roV1","roV2","ro1","ro2","canvas","color","fogC","T_earth","camera","scene","renderer","positions","particles","particle","count","dpr","lastW","W","window","innerWidth","H","innerHeight","aspect","vMin","Math","min","mouseX","mouseY","x0","y0","lookAt","THREE","Vector3","document","querySelector","WebGLRenderer","alpha","antialias","setSize","PerspectiveCamera","Scene","Emap","TextureLoader","load","anisotropy","capabilities","getMaxAnisotropy","Wmaterial","MeshStandardMaterial","onBeforeCompile","sh","vertexShader","replace","fragmentShader","posZ","roughness","metalness","envMapIntensity","emissive","transparent","alphaTest","set","side","extensions","derivatives","geometry","IcosahedronGeometry","i","vertices","length","applyEuler","Euler","random","bGeometry","BufferGeometry","fromGeometry","position","attributes","centers","Int8Array","brights","Float32Array","points","activePoints","vCount","dCount","dMid","l","c","j","siblings","distances","indexes","brightness","v","a","f","dr","r","addSiblings","b","one","indexOf","pos","clone","push","distanceTo","faces","forEach","face","ttl","setActive","n","z","isActive","addAttribute","BufferAttribute","Ematerial","alphaMap","cubeCamera","CubeCamera","envMap","renderTarget","texture","minFilter","LinearMipMapLinearFilter","mapping","CubeReflectionMapping","Mesh","wGeometry","Group","world","Net","add","fog","Fog","hLight","HemisphereLight","dx","dy","active","abc","movedPoints","activeF","ready","raycaster","Raycaster","mouse","Vector2","getWpos","rotation","interact","x","y","setFromCamera","point","inters","intersectObject","ind","vert","worldToLocal","some","p","max","onpointerdown","onmousedown","ontouchstart","e","changedTouches","clientX","clientY","preventDefault","onpointermove","onmousemove","ontouchmove","buttons","touches","identifier","undefined","type","onmouseup","onpointerup","ontouchup","ontouchcancel","onpointercancel","onblur","t0","Date","dMax","dMin","dT","af","Pactive","m","k","k0","f0","fv","posArr","array","pUp","pDn","flTimer","vecTest","transStart","pLast","transactions","requestAnimationFrame","animate","t","dt","dd","getBoundingClientRect","dY","documentElement","bottom","top","devicePixelRatio","setPixelRatio","updateProjectionMatrix","addPoints","speed","s","splice","abs","bright","needsUpdate","rotateY","rotateX","sro","applyMatrix","Matrix4","getInverse","matrixWorld","multiply","makeRotationFromEuler","visible","scale","update","matrixWorldNeedsUpdate","render"],"mappings":"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","sourcesContent":["import React, { Component } from 'react'\n\nexport default class Earth extends Component {\n    componentDidMount() {\n        //(function(){\n\tvar AMOUNT=200, d=25, R=200, adjustment=true, adaptive=true,\n    obliquity=23/180*3.14, roV1=.0022, roV2=-.0005, ro1=0, ro2=0,\n    canvas='#earth', color='#420236', fogC='#722779', T_earth='https://mapplix.github.io/earth/earth.png';\n\nvar camera, scene, renderer;\n\nvar positions=[], particles, particle, count = 0, dpr, lastW,\nW=window.innerWidth, H=window.innerHeight, aspect=W / H, vMin=Math.min(W,H);\n\nvar mouseX = 0, mouseY = 0, x0, y0;\nvar lookAt=new THREE.Vector3(0, 0, 0), canvas=document.querySelector(canvas); \n\nrenderer = new THREE.WebGLRenderer({alpha:true, antialias:true, canvas: canvas});//\nrenderer.setSize( W, H );\n//renderer.context.getExtension('OES_standard_derivatives');\ncamera = new THREE.PerspectiveCamera( 18, aspect, 1, 10000 );\nscene = new THREE.Scene();\nvar Emap = (new THREE.TextureLoader()).load( T_earth );\nEmap.anisotropy=Math.min(8, renderer.capabilities.getMaxAnisotropy())||1;\nvar Wmaterial = new THREE.MeshStandardMaterial({\n    onBeforeCompile: function(sh){\n        sh.vertexShader='\\\n#define MYSHADER\\n\\\nattribute float center, bright;\\n\\\nvarying vec3 vCenter, vPos, vV0, vV1, vV2;\\n\\\nvarying float vBright;\\n\\\n'\t\t\t+sh.vertexShader.replace(/}\\s*$/, '\\\nvBright=bright;\\n\\\nint c=int(center);\\n\\\nvCenter = vec3(c==0, c==1, c==2);\\n\\\nvPos=position;\\n\\\ngl_Position = projectionMatrix * modelViewMatrix * vec4(vPos, 1);\\n\\\nvV0=vCenter[0]*vPos;\\n\\\nvV1=vCenter[1]*vPos;\\n\\\nvV2=vCenter[2]*vPos;\\n\\\n}\\\t\t\t');\n        sh.fragmentShader='\\\n#define MYSHADER\\n\\\nvarying vec3 vCenter, vPos, vV0, vV1, vV2;\\n\\\nvarying float vBright;\\n\\\n'\t\t\t+sh.fragmentShader.replace('#include <alphamap_fragment>', '\\\n#include <alphamap_fragment>\\n\\\nvec3 d = fwidth( vCenter );\\n\\\nvec3 a3 = smoothstep( vec3(0.0), d * 1.4, vCenter+0.4*d-1.0/fogDepth );\\n\\\nfloat scale = dot(normalize(vViewPosition), vNormal);\\n\\\nscale = 1.0-scale*scale;\\n\\\nfloat dist = distance(vPos, vV0.xyz/vCenter.x);\\n\\\ndist = min(dist, distance(vPos, vV1.xyz/vCenter.y));\\n\\\ndist = min(dist, distance(vPos, vV2.xyz/vCenter.z));\\n\\\nfloat b3 = smoothstep(1.5, 1.8, dist-1.5*scale*scale );\\n\\\nfloat edgeFactorTri=min(b3,min( min( a3.x, a3.y ), a3.z ));\\n\\\ndiffuseColor.a *= mix( 1.0,  0.0, edgeFactorTri );\\n\\\nfloat dissipation='+(posZ+.5*R+.01)+';\\n\\\ndiffuseColor.a *= smoothstep( 20.0,  0.0, fogDepth-dissipation );\\n\\\n\\\t\t\t').replace('\t#include <fog_fragment>', '\\\nfloat lVc=length(vCenter);\\n\\\ngl_FragColor.rgb *= smoothstep( '+R*.8888+', '+R*1.201+', fogDepth );\\n\\\ngl_FragColor.rgb = mix( gl_FragColor.rgb, vec3(3), (.1*lVc+pow(lVc,8.0))*vBright );\\n\\\n#include <fog_fragment>\\\n\\\t\t\t');\n        //console.log(sh, sh.vertexShader, sh.fragmentShader);\n    },\n    roughness: .5,\n    metalness: .964,\n    envMapIntensity:5,\n    emissive: 0,\n    // refractionRatio: -0.12,\n    transparent: true, alphaTest: 0.05\n});//, opacity: 0\nWmaterial.color.set(fogC);\nWmaterial.side=2;\nWmaterial.extensions={derivatives: 1};\nvar geometry = new THREE.IcosahedronGeometry(R,3);//OctahedronGeometry\n\nfor ( var i = 0; i < geometry.vertices.length; i ++ ) {\n    geometry.vertices[i].applyEuler(new THREE.Euler(Math.random()*.06,Math.random()*.06,Math.random()*.06))\n}\nvar bGeometry=(new THREE.BufferGeometry).fromGeometry(geometry);\nvar position = bGeometry.attributes.position;\nvar centers = new Int8Array( position.count );\nvar brights = new Float32Array ( position.count );\nvar points=[], activePoints=[], vCount=geometry.vertices.length, dCount=0, dMid=0;\n\nfor ( var i = 0, l = position.count; i < l; i ++ ) {\n    var c =centers[i]= i % 3, j=(i-c)/3;\n    brights[i]=0;\n    if (i<vCount) points[i]={siblings:[], distances:[], indexes:[], brightness:0, v:0, a:0, f:0, dr:0, r:1};\n}\nfunction addSiblings(a,b,one){\n    if (points[a].siblings.indexOf(points[b])<0) {\n        points[a].pos=geometry.vertices[a].clone();\n        points[a].siblings.push(points[b]);\n        var d=geometry.vertices[a].distanceTo(geometry.vertices[b]);\n        points[a].distances.push(d);\n        dMid+=d; dCount++;\n    }\n    if (!one) addSiblings(b,a,1)\n}\ngeometry.faces.forEach(function(face, i){\n    addSiblings(face.a,face.b);\n    addSiblings(face.a,face.c);\n    addSiblings(face.c,face.b);\n    points[face.a].indexes.push(i*3);\n    points[face.b].indexes.push(i*3+1);\n    points[face.c].indexes.push(i*3+2);\n});\ndMid/=dCount;\nvar ttl=10;\n(function setActive(n){\n    if (!n) return\n    var i=parseInt(Math.random()*vCount)\n    if (geometry.vertices[i].z<-100) setActive()\n    else points[i].isActive=ttl, activePoints.push(points[i]);\n    setActive(n-1) \n})(10);\n\nbGeometry.addAttribute( 'center', new THREE.BufferAttribute( centers, 1 ) );\nbGeometry.addAttribute( 'bright', new THREE.BufferAttribute( brights, 1 ) );\n\nvar Ematerial = Wmaterial.clone();\nEmaterial.alphaMap=Emap; Ematerial.transparent=false; Ematerial.side=0;\nvar cubeCamera = new THREE.CubeCamera( 1, 2*R, 256 );\ncubeCamera.position.z=.47*R\nEmaterial.envMap=cubeCamera.renderTarget.texture;\nEmaterial.envMap.minFilter = THREE.LinearMipMapLinearFilter; \nEmaterial.envMap.mapping=THREE.CubeReflectionMapping;\nvar Earth = new THREE.Mesh(new THREE.IcosahedronGeometry(R*.77, 3), Ematerial)\nvar wGeometry=geometry.clone();\nparticles = new THREE.Group();\nworld = new THREE.Group();\nvar Net=new THREE.Mesh(bGeometry, Wmaterial);\nparticles.add(Net, Earth);//new THREE.Points(geometry, Pmaterial), \n//particles.rotation.order='YXZ'\nworld.add(particles);\nscene.add(world);\n// POSITIONS :\nvar posZ = 1700; //distance to camera\n//scene.position.set(-12,54,0);\n\n//camera.position.y=camera.position.z=2000\n\nscene.fog=new THREE.Fog(fogC, posZ-R/2, posZ+R);\nhLight=new THREE.HemisphereLight('#fff', 0, 23)\nworld.add(hLight);\nhLight.position.set(0,0,1)\n\n// interactions\nvar dx, dy=dx=x0=y0=0, active, abc=['a', 'b', 'c'], movedPoints=[], activeF=[], ready,\n    raycaster=new THREE.Raycaster(),\n    mouse = new THREE.Vector2();\nwindow.getWpos=function(){\n    return [scene.position, scene.rotation, camera]\n}\nfunction interact() {\n    mouse.x = ( x0 / W ) * 2 - 1;\n    mouse.y = - ( y0 / H ) * 2 + 1;\n    raycaster.setFromCamera( mouse, camera );\n    movedPoints.forEach(function(point, i){point.f=0});\n    activeF=[];\n    if (!active) return;\n    var inters=raycaster.intersectObject(Net)[0], ind, vert;\n    if (!inters) return;\n    point=Net.worldToLocal(inters.point.clone());\n    for (var i = 0; i < 3; i++) {\n        ind=inters.face[abc[i]];\n        if ( !points.some(function(p, i){return p.indexes.indexOf(ind)>=0 && (vert=i+'') }) ) return;\n        activeF[vert]=Math.max(1-point.distanceTo(points[vert].pos)/dMid, 0)*100\n    }\n    // console.log(activeF, points[vert]);\n}\ncanvas.onpointerdown=canvas.onmousedown=canvas.ontouchstart=function(e){\n    active=e.changedTouches?e.changedTouches[0]:e;\n    x0=active.clientX;\n    y0=active.clientY;\n    e.preventDefault();\n    interact();\n};\nonpointermove=onmousemove=ontouchmove=function(e){\n    if (!active || !ready) return\nif (!e.buttons) {\n  active=false;\n  return;\n}\n    var touches=e.changedTouches;\n    if (active.identifier!==undefined && e.type!='touchmove') return;\n    if (touches) {\n        if (touches[0].identifier==active.identifier) e=touches[0]\n        else return\n    }\n    else {e.preventDefault()};\n    //if (e.type==mousemove && !e.which) return\n    dx=(5*dx+x0-(x0=e.clientX))/6;\n    dy=(5*dy+y0-(y0=e.clientY))/6;\n    //console.log(e.type, active.identifier, dx, x0)\n    interact();\n    ready=0;\n};\nonmouseup=onpointerup=ontouchup=ontouchcancel=onpointercancel=onblur=function(e){\n    active=false;\n    //console.log()\n    interact();\n}\n\nvar t0=new Date()*1, dMax=80, dMin=1000/33, dT=1000/50, af, Pactive=[], m=3000000, k=400, k0=1, f0=.01, fv=1000,\n    posArr=bGeometry.attributes.position.array,\n    pUp=0, pDn=[], flTimer=[], vecTest=new THREE.Vector3(), transStart, pLast, transactions=[];\nrequestAnimationFrame(function animate() {\n    requestAnimationFrame( animate );\n    var t=new Date()*1, dt=t-t0;\n    if (dt<dMin) return; // !Eh || \n    dt=Math.min(dt, dMax);\n    t0=t;\n    var dd=dt/dT;\n    var pos=canvas.getBoundingClientRect(), dY=window.innerHeight-document.documentElement.getBoundingClientRect().bottom;\n    if (pos.bottom<=0 || pos.top>=window.innerHeight) return;\n    if (dpr!=(dpr=window.devicePixelRatio) || W!=(W=window.innerWidth) || H!=(H=window.innerHeight)) {\n        vMin=Math.min(W,H);\n        renderer.setSize(W, H);\n        renderer.setPixelRatio( dpr );\n        camera.aspect=W/H;\n        camera.updateProjectionMatrix();\n    }\n    var addPoints=[];\n    activePoints.forEach(function(point, i){\n        var b=point.brightness;\n        if (point.isActive && (b+=(point.speed||.3)*(b+.05)*dd) >1) {//\n            point.siblings.forEach(function(s, j){\n                if ( activePoints.indexOf(s)>-1) return //console.log(11);\n                s.speed=3.7/point.distances[j];\n                //s.from=point;\n                if (s.isActive=(Math.random()>.6)) activePoints.push(s);\n            })\n            point.isActive=0;\n        } else if (!point.isActive && (b-=b*.056*dd) < 0.005) {\n            b=0;//point.from=\n            activePoints.splice(i,1)\n        }\n        point.brightness=b;\n        point.indexes.forEach(function(i){\n            brights[i]=b;\n        });\n    });\n    points.forEach(function(point, i){\n        var d=0;\n        point.siblings.forEach(function(s,j){d+=s.dr;});\n        d=d/point.siblings.length-point.dr;\n        point.f=-(activeF[i]||0)*.4+d*k-point.dr*k0*(1+Math.abs(1-point.r))-point.v*fv;\n        point.v+=point.f*dt/m;\n        point.r=1+point.dr;\n        point.indexes.forEach(function(j){\n            //brights[i]+=point.f; return;\n            posArr[j*=3]=point.r*point.pos.x;\n            posArr[j+1]=point.r*point.pos.y;\n            posArr[j+2]=point.r*point.pos.z;\n        });\n    });\n    points.forEach(function(point, i){\n        if (!point.v) return;\n        var dd=point.v*dt;\n        point.dr+=dd;\n    });\n    bGeometry.attributes.bright.needsUpdate=true;\n    bGeometry.attributes.position.needsUpdate=true;\n    camera.position.z += (posZ - camera.position.z ) * .085*dd;\n    ro1+=roV1*dd; ro2+=roV2*dd;\n    particles.rotation.set(0,0,0);\n    particles.rotateY(ro2).rotateX(obliquity).rotateY(ro1);\n    particles.rotation.y-=.0009\n\n    dx*=(1-.03*dd);\n    dy*=(1-.03*dd);\n    ro2-=dx*.002;//+(W/2-y0)*(W/2-x0)*dy/vMin*.00004;\n    world.rotation.x-=dy*.002;\n    var sro=world.rotation.x*=.92;\n    Net.applyMatrix(new THREE.Matrix4().getInverse(particles.matrixWorld).multiply(\n            new THREE.Matrix4().makeRotationFromEuler(new THREE.Euler(-dy*.003, -dx*.002,0))\n        ).multiply(particles.matrixWorld)//new THREE.Matrix4()\n    );\n    Earth.visible=!1;\n    scene.scale.set(.33,.33, .65)//.applyEuler(new THREE.Euler(-sro,0,0))\n    cubeCamera.update( renderer, scene );\n    Earth.visible=!0;\n    scene.scale.set(1,1,1)\n    particles.matrixWorldNeedsUpdate=true;\n    renderer.render( scene, camera );\n    ready=1;\n})\n//})()\n    }\n    \n    render() {\n        return (\n            <div>\n                <canvas id=\"earth\"></canvas>\n            </div>\n        )\n    }\n}"]},"metadata":{},"sourceType":"module"}